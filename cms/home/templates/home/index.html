{% extends "medexCms/shared/base.html" %}
{% load staticfiles %}
{% load sass_tags %}

{% block extra_css %}
  <link href="{% sass_src 'scss/home/index.scss' %}" rel="stylesheet" type="text/css" >
{% endblock %}

{% block page %}
  <div class="case-index">
    <h1 class="page-title">
      ME Dashboard
    </h1>

    <div class="flex-row index-overview">
      <div class="overview-block nhsuk-grid-column-one-third">
        <p class="overview-heading">
          Displaying cases at
        </p>

        <p class="overview-body location">
          {{session_user.index_overview.view_location}}
        </p>
      </div>

      <div class="overview-block nhsuk-grid-column-one-third">
        <p class="overview-heading">
          Total number of cases
        </p>

        <p class="overview-body">
          {{session_user.index_overview.total_cases}}
        </p>
      </div>

      <div class="overview-block nhsuk-grid-column-one-third">
        <p class="overview-heading">
          Number of urgent cases
        </p>

        <p class="overview-body">
          {{session_user.index_overview.urgent_cases}}
        </p>
      </div>
    </div>

    <div class="filters-block">
      <form id="index-filters-form">
        <p>
          Filter cases by place and person
        </p>

        <div class="nhsuk-grid-row">
          <div class="nhsuk-grid-column-one-half">
            <div id='location-selector' class="nhsuk-form-group">
              <div class="search-dropdown">
                <input id="location" class='selection-field' type="text" name="location" value="{{form.location}}">

                <div class='search-field'>
                  <input type="text" name="searchField" placeholder="Search for a location">
                </div>

                <div class="options-list">
                  <p class="placeholder options-list--placeholder">Please enter at least 3 characters to search</p>

                  {% for location in filter_locations %}
                    <option value="{{location.id}}">{{location.name}}</option>
                  {% endfor %}
                </div>
              </div>
            </div>
          </div>

          <div class="nhsuk-grid-column-one-half">
            <div id='person-selector' class="nhsuk-form-group">
              <div class="search-dropdown">
                <input id="person" class='selection-field' type="text" name="person" value="{{form.person}}">

                <div class='search-field'>
                  <input type="text" name="searchField" placeholder="Search for a person">
                </div>

                <div class="options-list">
                  <p class="placeholder options-list--placeholder">Please enter at least 3 characters to search</p>

                  {% for person in filter_people %}
                    <option value="{{person.id}}">{{person.name}}</option>
                  {% endfor %}
                </div>
              </div>
            </div>
          </div>
        </div>
      </form>

      <img style="width:100%;" class='logo__icon' src="{% static 'images/placeholder_MEO_filters.png' %}" alt="">
    </div>

    <div class="sort-block">
      <div style="text-align:right;">
        <p style="margin: 0; border: 1px solid #000000;display: inline-block;padding: 3px 10px;">
          Urgency v
        </p>
      </div>
    </div>

    {% if session_user.examinations_count == 0 %}
      <h2>
        Currently there are no cases for these filters
      </h2>

      <p>
        Try choosing another place, person or status
      </p>
    {% else %}
      {% for examination in session_user.examinations %}
        {% include 'examinations/partials/_case_card.html' with case=examination %}
      {% endfor %}
    {% endif %}
  </div>
{% endblock %}

{% block extra_js %}
      <script src="{% static 'js/home/home.js' %}"></script>
{% endblock %}